<form id="loginForm">
	<h2>Login</h2>
	<label for="email">Email:</label>
	<input type="email" id="email" name="email" value="myemail@gmail.com" required><br><br>
	
	<label for="password">Password:</label>
	<input type="password" id="password" name="password" password="111111" required><br><br>
	
	<button id='login-submit' type="button" onclick="submitInitialForm()">Submit</button>
</form>

<div id="loginOtp" class="hidden">
<h2>Enter OTP</h2>
	<form id="loginOtpForm">
		<label for="otp">Received OTP:</label>
		<input type="text" id="otp" name="otp" required>
		<br><br>
		<button type="button" onclick="submitOtpForm()">Submit OTP</button>
	</form>
</div>

<script>
	async function submitInitialForm() {
		try {
			const email = document.getElementById('email').value;
			const password = document.getElementById('password').value;
			response = await fetch('/login/', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify({ email, password })
			})
			var success = response.ok
			data = await response.json();
			if (data.message)
				alert(data.message);
			else
				alert(data.detail);
			if (success) {
				document.getElementById('loginForm').classList.add('hidden');
				document.getElementById('loginOtp').classList.remove('hidden');
			}
		}
		catch (error) {
			console.error('Error:', error);
		}
	}
	async function submitOtpForm() {
		try{
			const email = document.getElementById('email').value;
			const otp = document.getElementById('otp').value;
			console.log(11);
			response = await fetch('/login-verify/', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify({ email, otp}),
			})
			var success = response.ok
			data = await response.json();
			if (data.message)
				alert(data.message);
			else
				alert(data.detail);
			if (success) {
				await loadContent('/home/', defaultOption, true);
			}
		}
		catch (error) {
			alert(error);
			console.error('Error:', error);
		}
	}
	
</script>